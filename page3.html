<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rendu de Monnaie - Adopt Rennes</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #FFE5F1 0%, #FFFFFF 100%);
            padding: 20px;
        }
        .header {
            background: linear-gradient(135deg, #FF1493 0%, #FF69B4 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
            position: relative;
        }
        .drapeau {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 0;
            border: 2px solid white;
            border-radius: 5px;
            overflow: hidden;
        }
        .drapeau > div {
            width: 20px;
            height: 40px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .student-info {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid #FF1493;
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        .student-info input {
            padding: 8px;
            border: 2px solid #FF1493;
            border-radius: 5px;
            font-size: 14px;
        }
        .student-info label {
            font-weight: bold;
            color: #FF1493;
        }
        .context-box {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid #FF1493;
        }
        .context-box h2 {
            color: #FF1493;
            margin-bottom: 15px;
        }
        .commande-recap {
            background: #FFF9F0;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #FFB6D9;
            margin: 15px 0;
        }
        .commande-recap table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        .commande-recap th {
            background: #FF1493;
            color: white;
            padding: 10px;
            text-align: left;
        }
        .commande-recap td {
            padding: 8px;
            border-bottom: 1px solid #FFB6D9;
        }
        .rupture-line {
            background: #FFCDD2;
            font-weight: bold;
        }
        .total-line {
            background: #FF1493;
            color: white;
            font-weight: bold;
            font-size: 1.1em;
        }
        .exercice {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid #FF1493;
        }
        .exercice h3 {
            color: #FF1493;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .exercice-number {
            display: inline-block;
            background: #FF1493;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-right: 10px;
        }
        .calcul-box {
            background: #E1F5FE;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            font-size: 1.2em;
            text-align: center;
        }
        .input-answer {
            padding: 10px 15px;
            border: 3px solid #FF1493;
            border-radius: 8px;
            font-size: 1.2em;
            width: 150px;
            text-align: center;
            font-weight: bold;
        }
        .money-bank {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #FF1493;
            margin: 15px 0;
        }
        .money-bank h4 {
            color: #FF1493;
            margin-bottom: 15px;
        }
        .money-items {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }
        .money-item {
            cursor: grab;
            transition: transform 0.2s;
            position: relative;
        }
        .money-item:hover {
            transform: scale(1.05);
        }
        .money-item:active {
            cursor: grabbing;
        }
        
        .billet {
            width: 150px;
            height: 75px;
            border-radius: 8px;
            border: 3px solid #333;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
        }
        .billet::before {
            content: '‚Ç¨';
            position: absolute;
            font-size: 80px;
            opacity: 0.1;
            font-weight: bold;
        }
        .billet-value {
            font-size: 2em;
            z-index: 1;
        }
        .billet-text {
            font-size: 0.7em;
            z-index: 1;
        }
        .billet-100 { 
            background: linear-gradient(135deg, #2E7D32 0%, #66BB6A 100%);
            border-color: #1B5E20;
        }
        .billet-50 { 
            background: linear-gradient(135deg, #E65100 0%, #FF9800 100%);
            border-color: #BF360C;
        }
        .billet-20 { 
            background: linear-gradient(135deg, #1565C0 0%, #42A5F5 100%);
            border-color: #0D47A1;
        }
        .billet-10 { 
            background: linear-gradient(135deg, #C2185B 0%, #F06292 100%);
            border-color: #880E4F;
        }
        .billet-5 { 
            background: linear-gradient(135deg, #616161 0%, #BDBDBD 100%);
            border-color: #424242;
        }
        
        .piece {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border: 5px solid;
            box-shadow: 0 4px 10px rgba(0,0,0,0.4), inset 0 -3px 8px rgba(0,0,0,0.3), inset 0 3px 8px rgba(255,255,255,0.4);
            color: #333;
            font-size: 1.1em;
            position: relative;
        }
        .piece::before {
            content: '';
            position: absolute;
            width: 50%;
            height: 50%;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.3);
            top: 10%;
            left: 10%;
        }
        .piece-2e { 
            background: radial-gradient(circle at 30% 30%, #FFD700, #FFA500);
            border-color: #CC8400;
            width: 80px;
            height: 80px;
            font-size: 1.4em;
        }
        .piece-1e { 
            background: radial-gradient(circle at 30% 30%, #FFD700, #DAA520);
            border-color: #B8860B;
            width: 75px;
            height: 75px;
            font-size: 1.2em;
        }
        .piece-50c { 
            background: radial-gradient(circle at 30% 30%, #FDB931, #D4AF37);
            border-color: #C5A028;
        }
        .piece-20c { 
            background: radial-gradient(circle at 30% 30%, #E5C100, #D4AF37);
            border-color: #BF9F30;
            width: 65px;
            height: 65px;
        }
        .piece-10c { 
            background: radial-gradient(circle at 30% 30%, #E5C100, #C19A2E);
            border-color: #A88526;
            width: 60px;
            height: 60px;
            font-size: 0.95em;
        }
        .piece-5c { 
            background: radial-gradient(circle at 30% 30%, #CD7F32, #D2691E);
            border-color: #8B4513;
            width: 55px;
            height: 55px;
            font-size: 0.9em;
        }
        .piece-2c { 
            background: radial-gradient(circle at 30% 30%, #D2691E, #A0522D);
            border-color: #8B4513;
            width: 50px;
            height: 50px;
            font-size: 0.85em;
        }
        .piece-1c { 
            background: radial-gradient(circle at 30% 30%, #CD7F32, #A0522D);
            border-color: #8B4513;
            width: 48px;
            height: 48px;
            font-size: 0.8em;
        }
        
        .drop-zone {
            background: #FFF9F0;
            padding: 20px;
            border-radius: 10px;
            border: 3px dashed #FF1493;
            min-height: 150px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            justify-content: center;
        }
        .drop-zone.drag-over {
            background: #FFE5F1;
            border-color: #FF1493;
            border-style: solid;
        }
        .drop-zone-empty {
            color: #999;
            font-style: italic;
        }
        .dropped-money {
            position: relative;
        }
        .remove-btn {
            position: absolute;
            top: -10px;
            right: -10px;
            background: #FF1493;
            color: white;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2em;
            border: 3px solid white;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            z-index: 10;
        }
        .remove-btn:hover {
            background: #DC143C;
        }
        .btn {
            background: linear-gradient(135deg, #FF1493 0%, #FF69B4 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 20, 147, 0.3);
        }
        .btn:active {
            transform: translateY(0);
        }
        .btn-secondary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .btn-print {
            background: linear-gradient(135deg, #4CAF50 0%, #66BB6A 100%);
        }
        .result {
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-weight: bold;
        }
        .result.success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #28a745;
        }
        .result.error {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
        }
        .result.warning {
            background: #fff3cd;
            color: #856404;
            border: 2px solid #ffc107;
        }
        .info-box {
            background: #FFF9E6;
            border-left: 4px solid #FFC107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .info-box ol {
            margin-left: 20px;
            margin-top: 10px;
        }
        .client-info {
            background: #E8F5E9;
            border-left: 4px solid #4CAF50;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            font-size: 1.1em;
            font-weight: bold;
        }
        @media print {
            .no-print {
                display: none !important;
            }
            body {
                background: white;
            }
            .header {
                background: #FF1493 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .exercice, .context-box, .student-info {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="drapeau">
                <div style="background: #0055A4;"></div>
                <div style="background: white;"></div>
                <div style="background: #EF4135;"></div>
            </div>
            <h1>üí∞ ENCAISSEMENT EN CAISSE</h1>
            <div style="font-size: 1.3em; margin-top: 10px;">ADOPT PARFUMS - Retrait Click & Collect</div>
            <button class="btn btn-print no-print" onclick="window.print()" style="position: absolute; bottom: 20px; left: 20px; padding: 10px 20px; font-size: 14px;">
                üñ®Ô∏è Imprimer en PDF
            </button>
        </div>

        <div class="student-info">
            <div>
                <label>üë§ Nom :</label>
                <input type="text" id="studentName" placeholder="Votre nom">
            </div>
            <div>
                <label>üë§ Pr√©nom :</label>
                <input type="text" id="studentFirstName" placeholder="Votre pr√©nom">
            </div>
            <div>
                <label>üìÖ Date :</label>
                <input type="date" id="studentDate">
            </div>
        </div>

        <div class="context-box">
            <h2>üì¶ Contexte : Commande WEB-3847 - Mme MARTIN Sophie</h2>
            <p><strong>Situation :</strong> La cliente vient retirer sa commande Click & Collect avec <strong>paiement en magasin</strong>. Vous devez encaisser le montant et rendre la monnaie.</p>
            
            <div class="commande-recap">
                <h3 style="color: #FF1493; margin-bottom: 10px;">üìã Bon de commande INITIAL</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Qt√©</th>
                            <th>Produit</th>
                            <th>Prix unitaire</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2</td>
                            <td>ADP-FLO-001 - Rose Charmeuse 50ml</td>
                            <td>15,95‚Ç¨</td>
                            <td>31,90‚Ç¨</td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>ADP-FRU-002 - Pink & Pop 100ml</td>
                            <td>19,95‚Ç¨</td>
                            <td>19,95‚Ç¨</td>
                        </tr>
                        <tr class="rupture-line">
                            <td><s>3</s> ‚Üí 2</td>
                            <td>ADP-GOU-001 - Little Sugar 100ml<br><small>‚ö†Ô∏è RUPTURE : 1 manquant</small></td>
                            <td>19,95‚Ç¨</td>
                            <td><s>59,85‚Ç¨</s> ‚Üí 39,90‚Ç¨</td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>ADP-MUS-001 - Musc Blanc Cocon 50ml</td>
                            <td>15,95‚Ç¨</td>
                            <td>15,95‚Ç¨</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>ADP-FRU-005 - Madame Bonheur 100ml</td>
                            <td>19,95‚Ç¨</td>
                            <td>39,90‚Ç¨</td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>ADP-GOU-005 - Black Cherry 50ml</td>
                            <td>15,95‚Ç¨</td>
                            <td>15,95‚Ç¨</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>ADP-FRU-003 - Sunset Kiss (Litchi) 30ml</td>
                            <td>11,95‚Ç¨</td>
                            <td>23,90‚Ç¨</td>
                        </tr>
                        <tr>
                            <td colspan="3" style="text-align: right;"><strong>Sous-total :</strong></td>
                            <td><strong>√Ä CALCULER</strong></td>
                        </tr>
                        <tr>
                            <td colspan="3" style="text-align: right;">Promotion Click & Collect (-10%) :</td>
                            <td>√Ä calculer</td>
                        </tr>
                        <tr class="total-line">
                            <td colspan="3" style="text-align: right;">TOTAL √Ä PAYER :</td>
                            <td>‚ùì √Ä CALCULER</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- EXERCICE 1 -->
        <div class="exercice">
            <h3><span class="exercice-number">1</span>Calculer le total √† payer</h3>
            
            <div class="info-box">
                <strong>üí° Aide :</strong> Consultez attentivement le bon de commande ci-dessus. Il y a eu une rupture de stock ET la cliente b√©n√©ficie d'une remise Click & Collect de -10%.
            </div>

            <div class="calcul-box">
                <p><strong>√âtape 1 :</strong> Calculez le sous-total avec la rupture de stock</p>
                <p><small>Attention : Un produit Little Sugar manque (passez de 3 √† 2 unit√©s)</small></p>
                <p><strong>√âtape 2 :</strong> Calculez la remise de -10%</p>
                <p><strong>√âtape 3 :</strong> Total final = Sous-total - Remise</p>
                <p style="margin-top: 20px; font-size: 1.3em;">
                    <strong>TOTAL √Ä PAYER =</strong> 
                    <input type="number" id="ex1-answer" class="input-answer" step="0.01" placeholder="0,00"> ‚Ç¨
                </p>
            </div>

            <button class="btn" onclick="verifierEx1()">‚úÖ V√©rifier</button>
            <div id="result1"></div>
        </div>

        <!-- EXERCICE 2 -->
        <div class="exercice">
            <h3><span class="exercice-number">2</span>Rendre la monnaie en esp√®ces</h3>
            
            <div class="client-info">
                üíµ La cliente vous donne : <strong>170‚Ç¨ en esp√®ces</strong>
            </div>

            <div class="info-box">
                <strong>üí° √âtapes :</strong>
                <ol>
                    <li>Utilisez le montant calcul√© √† l'exercice 1</li>
                    <li>Calculez mentalement la monnaie √† rendre : 170‚Ç¨ - Total = ?</li>
                    <li>Composez la monnaie en glissant les billets/pi√®ces dans la zone de rendu</li>
                </ol>
            </div>

            <div class="money-bank">
                <h4>üè¶ Caisse - Billets et pi√®ces disponibles</h4>
                <div class="money-items" id="bank2"></div>
            </div>

            <div style="background: #F5F5F5; padding: 20px; border-radius: 10px; border: 3px dashed #FF1493; margin: 15px 0;">
                <h4 style="color: #FF1493; margin-bottom: 15px;">üí∏ Glissez ici la monnaie √† rendre</h4>
                <div class="drop-zone" id="dropZone2">
                    <span class="drop-zone-empty">Glissez-d√©posez les billets et pi√®ces ici</span>
                </div>
                <p style="margin-top: 10px; text-align: center; font-weight: bold; font-size: 1.2em;">Total rendu : <span id="total2">0,00‚Ç¨</span></p>
            </div>

            <button class="btn" onclick="verifierEx2()">‚úÖ V√©rifier</button>
            <button class="btn btn-secondary" onclick="resetEx2()">üîÑ Recommencer</button>
            <div id="result2"></div>
        </div>

        <!-- EXERCICE 3 -->
        <div class="exercice">
            <h3><span class="exercice-number">3</span>Rendre la monnaie (avec ch√®que cadeau)</h3>
            
            <div class="client-info">
                üéÅ La cliente vous donne :<br>
                ‚Ä¢ <strong>100‚Ç¨ en ch√®que cadeau Adopt</strong><br>
                ‚Ä¢ <strong>1 billet de 100‚Ç¨</strong>
            </div>

            <div class="info-box">
                <strong>üí° √âtapes :</strong>
                <ol>
                    <li>Calculez le total donn√© par la cliente (ch√®que + esp√®ces)</li>
                    <li>Calculez la monnaie √† rendre</li>
                    <li>Composez la monnaie avec les billets/pi√®ces</li>
                </ol>
            </div>

            <div class="money-bank">
                <h4>üè¶ Caisse - Billets et pi√®ces disponibles</h4>
                <div class="money-items" id="bank3"></div>
            </div>

            <div style="background: #F5F5F5; padding: 20px; border-radius: 10px; border: 3px dashed #FF1493; margin: 15px 0;">
                <h4 style="color: #FF1493; margin-bottom: 15px;">üí∏ Glissez ici la monnaie √† rendre</h4>
                <div class="drop-zone" id="dropZone3">
                    <span class="drop-zone-empty">Glissez-d√©posez les billets et pi√®ces ici</span>
                </div>
                <p style="margin-top: 10px; text-align: center; font-weight: bold; font-size: 1.2em;">Total rendu : <span id="total3">0,00‚Ç¨</span></p>
            </div>

            <button class="btn" onclick="verifierEx3()">‚úÖ V√©rifier</button>
            <button class="btn btn-secondary" onclick="resetEx3()">üîÑ Recommencer</button>
            <div id="result3"></div>
        </div>

        <!-- EXERCICE 4 -->
        <div class="exercice">
            <h3><span class="exercice-number">4</span>D√âFI : Rendre la monnaie avec le MINIMUM de pi√®ces/billets üèÜ</h3>
            
            <div class="client-info">
                üíµ La cliente vous donne : <strong>200‚Ç¨ en esp√®ces</strong>
            </div>

            <div class="info-box">
                <strong>üéØ D√©fi :</strong> Rendez la monnaie en utilisant le <strong>MOINS de pi√®ces et billets possible</strong> !<br>
                <strong>üí° Astuce :</strong> Commencez par les plus grosses coupures et r√©fl√©chissez bien √† la composition optimale.
            </div>

            <div class="money-bank">
                <h4>üè¶ Caisse - Billets et pi√®ces disponibles</h4>
                <div class="money-items" id="bank4"></div>
            </div>

            <div style="background: #F5F5F5; padding: 20px; border-radius: 10px; border: 3px dashed #FF1493; margin: 15px 0;">
                <h4 style="color: #FF1493; margin-bottom: 15px;">üí∏ Glissez ici la monnaie √† rendre</h4>
                <div class="drop-zone" id="dropZone4">
                    <span class="drop-zone-empty">Glissez-d√©posez les billets et pi√®ces ici</span>
                </div>
                <p style="margin-top: 10px; text-align: center; font-weight: bold; font-size: 1.2em;">
                    Total rendu : <span id="total4">0,00‚Ç¨</span><br>
                    Nombre de pi√®ces/billets : <span id="count4">0</span>
                </p>
            </div>

            <button class="btn" onclick="verifierEx4()">‚úÖ V√©rifier</button>
            <button class="btn btn-secondary" onclick="resetEx4()">üîÑ Recommencer</button>
            <div id="result4"></div>
        </div>
    </div>

    <script>
        // D√©finition des monnaies disponibles
        const monnaies = [
            {value: 50, type: 'billet', class: 'billet-50', label: '50‚Ç¨'},
            {value: 20, type: 'billet', class: 'billet-20', label: '20‚Ç¨'},
            {value: 10, type: 'billet', class: 'billet-10', label: '10‚Ç¨'},
            {value: 5, type: 'billet', class: 'billet-5', label: '5‚Ç¨'},
            {value: 2, type: 'piece', class: 'piece-2e', label: '2‚Ç¨'},
            {value: 1, type: 'piece', class: 'piece-1e', label: '1‚Ç¨'},
            {value: 0.50, type: 'piece', class: 'piece-50c', label: '50c'},
            {value: 0.20, type: 'piece', class: 'piece-20c', label: '20c'},
            {value: 0.10, type: 'piece', class: 'piece-10c', label: '10c'},
            {value: 0.05, type: 'piece', class: 'piece-5c', label: '5c'},
            {value: 0.02, type: 'piece', class: 'piece-2c', label: '2c'},
            {value: 0.01, type: 'piece', class: 'piece-1c', label: '1c'}
        ];

        // R√©ponses correctes
        const totalAPayer = 168.71; // 187.45 - (187.45 * 0.10)
        const monnaieEx2 = 1.29; // 170 - 168.71
        const monnaieEx3 = 31.29; // 200 - 168.71
        const monnaieEx4 = 31.29; // 200 - 168.71
        const minBilletsEx4 = 5; // 1x20‚Ç¨ + 1x10‚Ç¨ + 1x1‚Ç¨ + 1x0.20‚Ç¨ + 1x0.05‚Ç¨ + 2x0.02‚Ç¨

        // Initialiser les banques
        function initBank(bankId) {
            const bank = document.getElementById(bankId);
            bank.innerHTML = '';
            monnaies.forEach((m, i) => {
                const item = document.createElement('div');
                item.className = 'money-item';
                item.draggable = true;
                item.dataset.value = m.value;
                item.dataset.type = m.type;
                
                if (m.type === 'billet') {
                    item.innerHTML = `
                        <div class="billet ${m.class}">
                            <div class="billet-value">${m.label}</div>
                            <div class="billet-text">EURO</div>
                        </div>
                    `;
                } else {
                    item.innerHTML = `<div class="piece ${m.class}">${m.label}</div>`;
                }
                
                item.addEventListener('dragstart', dragStart);
                bank.appendChild(item);
            });
        }

        // Initialiser toutes les banques au chargement
        initBank('bank2');
        initBank('bank3');
        initBank('bank4');

        // Gestion du drag & drop
        let draggedItem = null;

        function dragStart(e) {
            draggedItem = e.target.closest('.money-item');
            e.dataTransfer.effectAllowed = 'copy';
        }

        function dragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'copy';
            e.currentTarget.classList.add('drag-over');
        }

        function dragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function drop(e, dropZoneId) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            
            if (!draggedItem) return;
            
            const value = parseFloat(draggedItem.dataset.value);
            const type = draggedItem.dataset.type;
            
            // Cr√©er une copie de la monnaie
            const copy = draggedItem.cloneNode(true);
            copy.draggable = false;
            copy.classList.add('dropped-money');
            
            // Ajouter le bouton de suppression
            const removeBtn = document.createElement('div');
            removeBtn.className = 'remove-btn';
            removeBtn.innerHTML = '√ó';
            removeBtn.onclick = function() {
                copy.remove();
                updateTotal(dropZoneId);
            };
            
            copy.appendChild(removeBtn);
            
            // Retirer le message vide
            const emptyMsg = e.currentTarget.querySelector('.drop-zone-empty');
            if (emptyMsg) emptyMsg.remove();
            
            e.currentTarget.appendChild(copy);
            updateTotal(dropZoneId);
        }

        function updateTotal(dropZoneId) {
            const dropZone = document.getElementById(dropZoneId);
            const items = dropZone.querySelectorAll('.dropped-money');
            let total = 0;
            let count = 0;
            
            items.forEach(item => {
                total += parseFloat(item.dataset.value);
                count++;
            });
            
            const exerciceNum = dropZoneId.replace('dropZone', '');
            document.getElementById('total' + exerciceNum).textContent = total.toFixed(2) + '‚Ç¨';
            
            if (dropZoneId === 'dropZone4') {
                document.getElementById('count4').textContent = count;
            }
            
            // Ajouter message vide si n√©cessaire
            if (items.length === 0 && !dropZone.querySelector('.drop-zone-empty')) {
                const emptyMsg = document.createElement('span');
                emptyMsg.className = 'drop-zone-empty';
                emptyMsg.textContent = 'Glissez-d√©posez les billets et pi√®ces ici';
                dropZone.appendChild(emptyMsg);
            }
        }

        // Configurer les drop zones
        ['dropZone2', 'dropZone3', 'dropZone4'].forEach(id => {
            const zone = document.getElementById(id);
            zone.addEventListener('dragover', dragOver);
            zone.addEventListener('dragleave', dragLeave);
            zone.addEventListener('drop', (e) => drop(e, id));
        });

        // Fonctions de v√©rification
        function verifierEx1() {
            const answer = parseFloat(document.getElementById('ex1-answer').value);
            const result = document.getElementById('result1');
            
            if (!answer) {
                result.className = 'result warning';
                result.innerHTML = '‚ö†Ô∏è Veuillez entrer une r√©ponse.';
                return;
            }
            
            if (Math.abs(answer - totalAPayer) < 0.01) {
                result.className = 'result success';
                result.innerHTML = '‚úÖ <strong>Excellent !</strong> Le total √† payer est bien ' + totalAPayer.toFixed(2) + '‚Ç¨<br>' +
                    '<small>Calcul : 187,45‚Ç¨ - (187,45‚Ç¨ √ó 10%) = 187,45‚Ç¨ - 18,745‚Ç¨ = 168,71‚Ç¨</small>';
            } else {
                result.className = 'result error';
                result.innerHTML = '‚ùå <strong>Erreur.</strong> V√©rifiez votre calcul.<br>' +
                    '<small>üí° Astuce : Calculez d\'abord 10% de 187,45‚Ç¨, puis soustrayez ce montant.</small>';
            }
        }

        function verifierEx2() {
            const dropZone = document.getElementById('dropZone2');
            const items = dropZone.querySelectorAll('.dropped-money');
            let total = 0;
            
            items.forEach(item => {
                total += parseFloat(item.dataset.value);
            });
            
            const result = document.getElementById('result2');
            
            if (items.length === 0) {
                result.className = 'result warning';
                result.innerHTML = '‚ö†Ô∏è Veuillez glisser des billets/pi√®ces dans la zone de rendu.';
                return;
            }
            
            if (verifierMontantAvecArrondi(total, monnaieEx2)) {
                result.className = 'result success';
                result.innerHTML = '‚úÖ <strong>Parfait !</strong> Vous avez rendu ' + total.toFixed(2) + '‚Ç¨ de monnaie.<br>' +
                    '<small>170‚Ç¨ - 168,71‚Ç¨ = 1,29‚Ç¨ (ou arrondi √† 1,30‚Ç¨)</small>';
            } else if (total < monnaieEx2 - 0.05) {
                result.className = 'result error';
                result.innerHTML = '‚ùå <strong>Attention !</strong> Vous avez rendu ' + total.toFixed(2) + '‚Ç¨, mais vous devez rendre environ ' + monnaieEx2.toFixed(2) + '‚Ç¨.<br>' +
                    '<small>Il manque environ ' + (monnaieEx2 - total).toFixed(2) + '‚Ç¨.</small>';
            } else if (total > monnaieEx2 + 0.05) {
                result.className = 'result error';
                result.innerHTML = '‚ùå <strong>Attention !</strong> Vous avez rendu ' + total.toFixed(2) + '‚Ç¨, mais vous devez rendre environ ' + monnaieEx2.toFixed(2) + '‚Ç¨.<br>' +
                    '<small>Vous avez rendu environ ' + (total - monnaieEx2).toFixed(2) + '‚Ç¨ en trop.</small>';
            } else {
                result.className = 'result success';
                result.innerHTML = '‚úÖ <strong>Tr√®s bien !</strong> Arrondi acceptable : ' + total.toFixed(2) + '‚Ç¨<br>' +
                    '<small>Le montant exact est 1,29‚Ç¨, vous avez fait un arrondi correct.</small>';
            }
        }

        function resetEx2() {
            const dropZone = document.getElementById('dropZone2');
            dropZone.innerHTML = '<span class="drop-zone-empty">Glissez-d√©posez les billets et pi√®ces ici</span>';
            document.getElementById('total2').textContent = '0,00‚Ç¨';
            document.getElementById('result2').innerHTML = '';
        }

        function verifierEx3() {
            const dropZone = document.getElementById('dropZone3');
            const items = dropZone.querySelectorAll('.dropped-money');
            let total = 0;
            
            items.forEach(item => {
                total += parseFloat(item.dataset.value);
            });
            
            const result = document.getElementById('result3');
            
            if (items.length === 0) {
                result.className = 'result warning';
                result.innerHTML = '‚ö†Ô∏è Veuillez glisser des billets/pi√®ces dans la zone de rendu.';
                return;
            }
            
            if (verifierMontantAvecArrondi(total, monnaieEx3)) {
                result.className = 'result success';
                result.innerHTML = '‚úÖ <strong>Bravo !</strong> Vous avez rendu ' + total.toFixed(2) + '‚Ç¨ de monnaie.<br>' +
                    '<small>Total donn√© : 100‚Ç¨ (ch√®que) + 100‚Ç¨ (esp√®ces) = 200‚Ç¨<br>200‚Ç¨ - 168,71‚Ç¨ = 31,29‚Ç¨ (ou arrondi √† 31,30‚Ç¨)</small>';
            } else if (total < monnaieEx3 - 0.05) {
                result.className = 'result error';
                result.innerHTML = '‚ùå <strong>Attention !</strong> Vous avez rendu ' + total.toFixed(2) + '‚Ç¨, mais vous devez rendre environ ' + monnaieEx3.toFixed(2) + '‚Ç¨.<br>' +
                    '<small>Il manque environ ' + (monnaieEx3 - total).toFixed(2) + '‚Ç¨.</small>';
            } else if (total > monnaieEx3 + 0.05) {
                result.className = 'result error';
                result.innerHTML = '‚ùå <strong>Attention !</strong> Vous avez rendu ' + total.toFixed(2) + '‚Ç¨, mais vous devez rendre environ ' + monnaieEx3.toFixed(2) + '‚Ç¨.<br>' +
                    '<small>Vous avez rendu environ ' + (total - monnaieEx3).toFixed(2) + '‚Ç¨ en trop.</small>';
            } else {
                result.className = 'result success';
                result.innerHTML = '‚úÖ <strong>Tr√®s bien !</strong> Arrondi acceptable : ' + total.toFixed(2) + '‚Ç¨<br>' +
                    '<small>Le montant exact est 31,29‚Ç¨, vous avez fait un arrondi correct.</small>';
            }
        }

        function resetEx3() {
            const dropZone = document.getElementById('dropZone3');
            dropZone.innerHTML = '<span class="drop-zone-empty">Glissez-d√©posez les billets et pi√®ces ici</span>';
            document.getElementById('total3').textContent = '0,00‚Ç¨';
            document.getElementById('result3').innerHTML = '';
        }

        function verifierEx4() {
            const dropZone = document.getElementById('dropZone4');
            const items = dropZone.querySelectorAll('.dropped-money');
            let total = 0;
            let count = items.length;
            
            items.forEach(item => {
                total += parseFloat(item.dataset.value);
            });
            
            const result = document.getElementById('result4');
            
            if (items.length === 0) {
                result.className = 'result warning';
                result.innerHTML = '‚ö†Ô∏è Veuillez glisser des billets/pi√®ces dans la zone de rendu.';
                return;
            }
            
            if (verifierMontantAvecArrondi(total, monnaieEx4)) {
                if (count <= minBilletsEx4) {
                    result.className = 'result success';
                    result.innerHTML = 'üèÜ <strong>EXCELLENT !</strong> Vous avez rendu ' + total.toFixed(2) + '‚Ç¨ avec seulement ' + count + ' pi√®ces/billets !<br>' +
                        '<small>C\'est la solution optimale ! üëè<br>Composition optimale : 1√ó20‚Ç¨ + 1√ó10‚Ç¨ + 1√ó1‚Ç¨ + 1√ó0,20‚Ç¨ + 1√ó0,05‚Ç¨ + 2√ó0,02‚Ç¨ = 7 √©l√©ments</small>';
                } else {
                    result.className = 'result success';
                    result.innerHTML = '‚úÖ <strong>Correct !</strong> Vous avez rendu ' + total.toFixed(2) + '‚Ç¨ avec ' + count + ' pi√®ces/billets.<br>' +
                        '<small>üí° Mais saviez-vous qu\'on peut faire mieux avec seulement ' + minBilletsEx4 + ' pi√®ces/billets ?<br>Essayez de recommencer en utilisant les plus grosses coupures d\'abord !</small>';
                }
            } else if (total < monnaieEx4 - 0.05) {
                result.className = 'result error';
                result.innerHTML = '‚ùå <strong>Attention !</strong> Vous avez rendu ' + total.toFixed(2) + '‚Ç¨, mais vous devez rendre environ ' + monnaieEx4.toFixed(2) + '‚Ç¨.<br>' +
                    '<small>Il manque environ ' + (monnaieEx4 - total).toFixed(2) + '‚Ç¨.</small>';
            } else if (total > monnaieEx4 + 0.05) {
                result.className = 'result error';
                result.innerHTML = '‚ùå <strong>Attention !</strong> Vous avez rendu ' + total.toFixed(2) + '‚Ç¨, mais vous devez rendre environ ' + monnaieEx4.toFixed(2) + '‚Ç¨.<br>' +
                    '<small>Vous avez rendu environ ' + (total - monnaieEx4).toFixed(2) + '‚Ç¨ en trop.</small>';
            } else {
                result.className = 'result success';
                result.innerHTML = '‚úÖ <strong>Tr√®s bien !</strong> Arrondi acceptable : ' + total.toFixed(2) + '‚Ç¨ avec ' + count + ' pi√®ces/billets.<br>' +
                    '<small>Le montant exact est 31,29‚Ç¨. Solution optimale : ' + minBilletsEx4 + ' √©l√©ments.</small>';
            }
        }

        function resetEx4() {
            const dropZone = document.getElementById('dropZone4');
            dropZone.innerHTML = '<span class="drop-zone-empty">Glissez-d√©posez les billets et pi√®ces ici</span>';
            document.getElementById('total4').textContent = '0,00‚Ç¨';
            document.getElementById('count4').textContent = '0';
            document.getElementById('result4').innerHTML = '';
        }

        // Initialiser la date du jour
        document.getElementById('studentDate').valueAsDate = new Date();
    </script>
</body>
</html>
